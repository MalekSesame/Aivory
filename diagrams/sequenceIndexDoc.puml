@startuml
title Diagramme de séquence- Flux d'Indexation

participant U as "Utilisateur"
participant F as "Frontend"
participant G as "API Gateway"
participant S as "Storage Service"
participant Q as "Message Queue"
participant W as "Worker"
participant P as "Processor"
participant V as "Vector DB"
participant D as "Metadata DB"

U ->> F : 1. Sélection fichier
F ->> G : 2. POST /api/documents
G ->> S : 3. Stockage temporaire
S -->> G : 4. URL fichier
G ->> Q : 5. Création tâche
G ->> D : 6. Enregistrement
G -->> F : 7. "Traitement en cours"

W ->> Q : 8. Récupération tâche
W ->> S : 9. Téléchargement
W ->> P : 10. Extraction texte
W ->> P : 11. Segmentation
W ->> P : 12. Génération embeddings
W ->> V : 13. Insertion vecteurs
W ->> D : 14. Mise à jour métadonnées
W ->> F : 15. Notification WebSocket
F -->> U : 16. "Document indexé"

@enduml
